#!/bin/bash

# ATB Trading Dashboard v2.0 - Linux Launcher —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π venv
set -e

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
APP_NAME="ATB Trading Dashboard"
APP_VERSION="v2.0"
PYTHON_MIN_VERSION="3.8"
LOG_FILE="logs/launcher.log"
VENV_DIR="venv"

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
mkdir -p logs data config temp backups

# –ù–∞—á–∞–ª–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
echo "$(date) - Launcher started" >> "$LOG_FILE"

# –û—á–∏—Å—Ç–∫–∞ —ç–∫—Ä–∞–Ω–∞ –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
clear
echo
echo "                    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó "
echo "                    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó"
echo "                    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë"
echo "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë  ‚ïö‚ñà‚ñà‚ïî‚ïù  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë"
echo "                    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë"
echo "                    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù"
echo
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
echo "                    üöÄ $APP_NAME $APP_VERSION üöÄ"
echo "                         Advanced Trading Platform Launcher (VENV)"
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
echo

# –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ Python
check_python() {
    echo "[‚ö°] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π..."
    echo
    
    # –ü–æ–∏—Å–∫ Python
    PYTHON_BASE=""
    if command -v python3 &> /dev/null; then
        PYTHON_BASE="python3"
    elif command -v python &> /dev/null; then
        PYTHON_BASE="python"
    else
        echo "‚ùå –û–®–ò–ë–ö–ê: Python –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ!"
        echo
        echo "üì• –î–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è Python $PYTHON_MIN_VERSION+"
        echo "üåê –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python: sudo apt install python3 python3-pip python3-venv"
        echo "üîß –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã"
        echo
        exit 1
    fi
    
    PYTHON_VER=$($PYTHON_BASE --version 2>&1 | cut -d' ' -f2)
    echo "‚úÖ Python –Ω–∞–π–¥–µ–Ω: $PYTHON_VER (–∫–æ–º–∞–Ω–¥–∞: $PYTHON_BASE)"
    echo "$(date) - Python version: $PYTHON_VER" >> "$LOG_FILE"
    
    # –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–º–∞–Ω–¥—ã Python –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    export PYTHON_BASE
}

# –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è/–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
setup_virtual_environment() {
    echo "[üõ†Ô∏è] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
    
    if [ ! -d "$VENV_DIR" ]; then
        echo "üì¶ –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
        if ! $PYTHON_BASE -m venv "$VENV_DIR"; then
            echo "‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è"
            echo "üí° –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: sudo apt install python3-venv"
            exit 1
        fi
        echo "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ"
    else
        echo "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ"
    fi
    
    # –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    source "$VENV_DIR/bin/activate"
    PYTHON_CMD="$VENV_DIR/bin/python"
    PIP_CMD="$VENV_DIR/bin/pip"
    
    echo "üîÑ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ"
    echo "üìç Python: $PYTHON_CMD"
    echo "üìç Pip: $PIP_CMD"
    
    # –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–º–∞–Ω–¥ –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    export PYTHON_CMD PIP_CMD
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
check_base_modules() {
    echo "[üîç] –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π..."
    if ! $PYTHON_CMD -c "import sys, os, asyncio, logging, json, threading, decimal, datetime, pathlib" 2>/dev/null; then
        echo "‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –±–∞–∑–æ–≤—ã–µ –º–æ–¥—É–ª–∏ Python!"
        echo "üîß –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –º–æ–¥—É–ª–µ–π"
        exit 1
    fi
    echo "‚úÖ –ë–∞–∑–æ–≤—ã–µ –º–æ–¥—É–ª–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã"
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ GUI –º–æ–¥—É–ª–µ–π
check_gui() {
    echo "[üñ•Ô∏è] –ü—Ä–æ–≤–µ—Ä–∫–∞ GUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤..."
    if ! $PYTHON_CMD -c "import tkinter" 2>/dev/null; then
        echo "‚ö†Ô∏è WARNING: Tkinter –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
        echo "üì± GUI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—É–¥–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω"
        echo "üí° –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: sudo apt install python3-tk"
    else
        echo "‚úÖ Tkinter –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ"
    fi
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—É—á–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
check_scientific_libs() {
    echo "[üìä] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫..."
    MISSING_LIBS=""
    
    if ! $PYTHON_CMD -c "import numpy" 2>/dev/null; then
        MISSING_LIBS="$MISSING_LIBS numpy"
    fi
    
    if ! $PYTHON_CMD -c "import pandas" 2>/dev/null; then
        MISSING_LIBS="$MISSING_LIBS pandas"
    fi
    
    if ! $PYTHON_CMD -c "import matplotlib" 2>/dev/null; then
        MISSING_LIBS="$MISSING_LIBS matplotlib"
    fi
    
    if [ -n "$MISSING_LIBS" ]; then
        echo "‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:$MISSING_LIBS"
        echo
        echo "[üíø] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ venv..."
        echo "üîÑ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç..."
        echo
        
        $PIP_CMD install --upgrade pip
        for lib in $MISSING_LIBS; do
            echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ $lib..."
            if $PIP_CMD install "$lib"; then
                echo "‚úÖ $lib —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ"
            else
                echo "‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ $lib"
            fi
        done
        echo
        echo "üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
        check_scientific_libs
        return
    fi
    
    echo "‚úÖ –í—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ"
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
check_optional_features() {
    echo "[üß™] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞..."
    OPTIONAL_FEATURES=""
    
    if $PYTHON_CMD -c "import requests" 2>/dev/null; then
        OPTIONAL_FEATURES="$OPTIONAL_FEATURES ‚úÖAPI-–∫–ª–∏–µ–Ω—Ç"
    else
        OPTIONAL_FEATURES="$OPTIONAL_FEATURES ‚ùåAPI-–∫–ª–∏–µ–Ω—Ç"
        echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ requests..."
        $PIP_CMD install requests
    fi
    
    if $PYTHON_CMD -c "import websocket" 2>/dev/null; then
        OPTIONAL_FEATURES="$OPTIONAL_FEATURES ‚úÖWebSocket"
    else
        OPTIONAL_FEATURES="$OPTIONAL_FEATURES ‚ùåWebSocket"
        echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ websocket-client..."
        $PIP_CMD install websocket-client
    fi
    
    if $PYTHON_CMD -c "import fastapi" 2>/dev/null; then
        OPTIONAL_FEATURES="$OPTIONAL_FEATURES ‚úÖFastAPI"
    else
        OPTIONAL_FEATURES="$OPTIONAL_FEATURES ‚ùåFastAPI"
        echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ fastapi..."
        $PIP_CMD install fastapi uvicorn
    fi
    
    echo "üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏:$OPTIONAL_FEATURES"
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
check_file_structure() {
    echo "[üìÅ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã..."
    [ -d "domain" ] && echo "‚úÖ –î–æ–º–µ–Ω–Ω—ã–π —Å–ª–æ–π"
    [ -d "application" ] && echo "‚úÖ –°–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"
    [ -d "infrastructure" ] && echo "‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π"
    [ -d "interfaces" ] && echo "‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã–π —Å–ª–æ–π"
}

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ requirements.txt –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
install_requirements() {
    if [ -f "requirements.txt" ]; then
        echo "[üìã] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏–∑ requirements.txt..."
        $PIP_CMD install -r requirements.txt
        echo "‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
    fi
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
check_config() {
    echo "[‚öôÔ∏è] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."
    if [ -f "launcher_config.json" ]; then
        echo "‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è launcher'–∞ –Ω–∞–π–¥–µ–Ω–∞"
    else
        echo "üîß –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é..."
        $PYTHON_CMD -c "
import json
config = {
    'auto_start_components': ['database', 'trading_engine', 'dashboard'],
    'dashboard_port': 8080,
    'environment': 'development',
    'use_virtual_env': True,
    'venv_path': '$VENV_DIR'
}
with open('launcher_config.json', 'w') as f:
    json.dump(config, f, indent=2)
"
        echo "‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞"
    fi
}

# –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
main_menu() {
    while true; do
        echo
        echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
        echo "                     üéØ –°–ò–°–¢–ï–ú–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê"
        echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
        echo
        echo "[üéÆ] –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –∑–∞–ø—É—Å–∫–∞:"
        echo
        echo "    1Ô∏è‚É£  - –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)"
        echo "    2Ô∏è‚É£  - –¢–æ–ª—å–∫–æ –¥–∞—à–±–æ—Ä–¥"
        echo "    3Ô∏è‚É£  - –°–∏—Å—Ç–µ–º–Ω—ã–π launcher (Advanced)"
        echo "    4Ô∏è‚É£  - –ü—Ä–æ—Å—Ç–æ–π —Ä–µ–∂–∏–º (–±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç)"
        echo "    5Ô∏è‚É£  - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã"
        echo "    6Ô∏è‚É£  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏"
        echo "    7Ô∏è‚É£  - –°–ø—Ä–∞–≤–∫–∞"
        echo "    8Ô∏è‚É£  - –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å venv –∏ –≤—ã–π—Ç–∏"
        echo "    0Ô∏è‚É£  - –í—ã—Ö–æ–¥"
        echo
        read -p "üëâ –í–∞—à –≤—ã–±–æ—Ä (1-8, 0 –¥–ª—è –≤—ã—Ö–æ–¥–∞): " choice
        
        case $choice in
            1) full_launch ;;
            2) dashboard_only ;;
            3) system_launcher ;;
            4) simple_mode ;;
            5) diagnostics ;;
            6) settings ;;
            7) help ;;
            8) deactivate_and_exit ;;
            0) exit_launcher ;;
            *) echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞." ;;
        esac
    done
}

# –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
full_launch() {
    clear
    echo
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "                    üöÄ –ü–û–õ–ù–´–ô –ó–ê–ü–£–°–ö –°–ò–°–¢–ï–ú–´ ATB"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo
    echo "[üîÑ] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤..."
    echo "üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: $VENV_DIR"
    echo
    echo "$(date) - Full system launch initiated (venv)" >> "$LOG_FILE"
    
    if $PYTHON_CMD atb_launcher.py; then
        echo "‚úÖ –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ"
    else
        echo "‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã (–∫–æ–¥: $?)"
        echo "üìã –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª–µ: $LOG_FILE"
    fi
    end_operation
}

# –¢–æ–ª—å–∫–æ –¥–∞—à–±–æ—Ä–¥
dashboard_only() {
    clear
    echo
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "                      üìä –ó–ê–ü–£–°–ö –î–ê–®–ë–û–†–î–ê"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo
    echo "[üñ•Ô∏è] –ó–∞–ø—É—Å–∫ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞..."
    echo "üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: $VENV_DIR"
    echo
    echo "$(date) - Dashboard-only launch (venv)" >> "$LOG_FILE"
    
    if $PYTHON_CMD run_dashboard.py; then
        echo "‚úÖ –î–∞—à–±–æ—Ä–¥ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ"
    else
        echo "‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞"
    fi
    end_operation
}

# –°–∏—Å—Ç–µ–º–Ω—ã–π launcher
system_launcher() {
    clear
    echo
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "                   ‚ö° –°–ò–°–¢–ï–ú–ù–´–ô LAUNCHER (ADVANCED)"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo
    echo "[üîß] –ó–∞–ø—É—Å–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ launcher'–∞..."
    echo "üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫, API —Å–µ—Ä–≤–µ—Ä"
    echo "üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: $VENV_DIR"
    echo
    echo "$(date) - Advanced launcher mode (venv)" >> "$LOG_FILE"
    
    # –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ —Å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–º venv
    bash -c "source $VENV_DIR/bin/activate && $PYTHON_CMD atb_launcher.py" &
    echo "‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π launcher –∑–∞–ø—É—â–µ–Ω –≤ —Ñ–æ–Ω–µ (PID: $!)"
    end_operation
}

# –ü—Ä–æ—Å—Ç–æ–π —Ä–µ–∂–∏–º
simple_mode() {
    clear
    echo
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "                     ‚ö° –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo
    echo "[üöÑ] –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏..."
    echo "üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: $VENV_DIR"
    echo
    echo "$(date) - Simple mode launch (venv)" >> "$LOG_FILE"
    
    # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Python –∏ –ø—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫
    $PYTHON_CMD -c "print('‚úÖ Python –≥–æ—Ç–æ–≤')"
    echo "[üöÄ] –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ –¥–∞—à–±–æ—Ä–¥–∞..."
    $PYTHON_CMD run_dashboard.py
    end_operation
}

# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
diagnostics() {
    clear
    echo
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "                      üîç –°–ò–°–¢–ï–ú–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo
    echo "[üìä] –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã..."
    echo
    
    # –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
    echo "üîç –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ:"
    echo "  ‚ñ∂ –û–°: $(uname -s) $(uname -r)"
    echo "  ‚ñ∂ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: $(uname -m)"
    echo "  ‚ñ∂ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $(whoami)"
    echo "  ‚ñ∂ –í—Ä–µ–º—è: $(date)"
    echo
    
    echo "üõ†Ô∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:"
    echo "  ‚ñ∂ –ü—É—Ç—å: $VENV_DIR"
    echo "  ‚ñ∂ –ê–∫—Ç–∏–≤–Ω–æ: $([ "$VIRTUAL_ENV" ] && echo "–î–∞" || echo "–ù–µ—Ç")"
    echo "  ‚ñ∂ Python: $PYTHON_CMD"
    echo "  ‚ñ∂ Pip: $PIP_CMD"
    echo
    
    echo "üêç Python –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:"
    $PYTHON_CMD -c "
import sys, platform
print(f'  ‚ñ∂ –í–µ—Ä—Å–∏—è: {sys.version}')
print(f'  ‚ñ∂ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: {platform.platform()}')
print(f'  ‚ñ∂ –ü—É—Ç—å: {sys.executable}')
"
    echo
    
    echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:"
    $PIP_CMD list | grep -E "(numpy|pandas|matplotlib|requests|fastapi|websocket)" || echo "  –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
    echo
    
    echo "üíæ –î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ:"
    df -h . | tail -1
    echo
    
    echo "üåê –°–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:"
    if ping -c 1 google.com >/dev/null 2>&1; then
        echo "  ‚úÖ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ"
    else
        echo "  ‚ùå –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ"
    fi
    echo
    
    echo "üìã –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
    read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
}

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
settings() {
    while true; do
        clear
        echo
        echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
        echo "                         ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò"
        echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
        echo
        echo "[üîß] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã:"
        echo
        echo "    1Ô∏è‚É£  - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å launcher_config.json"
        echo "    2Ô∏è‚É£  - –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏"
        echo "    3Ô∏è‚É£  - –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à"
        echo "    4Ô∏è‚É£  - –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏"
        echo "    5Ô∏è‚É£  - –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ"
        echo "    6Ô∏è‚É£  - –°–±—Ä–æ—Å –∫ –∑–∞–≤–æ–¥—Å–∫–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º"
        echo "    0Ô∏è‚É£  - –ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"
        echo
        read -p "üëâ –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: " settings_choice
        
        case $settings_choice in
            1)
                echo "[üìù] –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."
                if [ -f "launcher_config.json" ]; then
                    ${EDITOR:-nano} launcher_config.json
                else
                    echo "‚ùå –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω"
                fi
                ;;
            2)
                echo "[üßπ] –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤..."
                rm -f logs/*.log
                echo "‚úÖ –õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã"
                ;;
            3)
                echo "[üßπ] –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞..."
                rm -rf temp/* __pycache__ .pytest_cache
                find . -name "*.pyc" -delete
                echo "‚úÖ –ö—ç—à –æ—á–∏—â–µ–Ω"
                ;;
            4)
                echo "[üîÑ] –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ venv..."
                $PIP_CMD install --upgrade --force-reinstall numpy pandas matplotlib requests fastapi websocket-client
                echo "‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
                ;;
            5)
                echo "[‚ö†Ô∏è] –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
                read -p "–≠—Ç–æ —É–¥–∞–ª–∏—Ç —Ç–µ–∫—É—â–µ–µ venv. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (y/N): " confirm
                if [ "$confirm" = "y" ] || [ "$confirm" = "Y" ]; then
                    deactivate 2>/dev/null || true
                    rm -rf "$VENV_DIR"
                    setup_virtual_environment
                    echo "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–æ"
                fi
                ;;
            6)
                echo "[‚ö†Ô∏è] –°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫ –∑–∞–≤–æ–¥—Å–∫–∏–º..."
                rm -f launcher_config.json
                echo "‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã"
                ;;
            0)
                return
                ;;
            *)
                echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä"
                ;;
        esac
        
        if [ "$settings_choice" != "0" ]; then
            read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
        fi
    done
}

# –°–ø—Ä–∞–≤–∫–∞
help() {
    clear
    echo
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "                          üìö –°–ü–†–ê–í–ö–ê ATB"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo
    echo "üéØ ATB Trading Dashboard v2.0 - –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (VENV –≤–µ—Ä—Å–∏—è)"
    echo
    echo "üìã –†–ï–ñ–ò–ú–´ –ó–ê–ü–£–°–ö–ê:"
    echo "  1Ô∏è‚É£ –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫    - –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã"
    echo "  2Ô∏è‚É£ –¢–æ–ª—å–∫–æ –¥–∞—à–±–æ—Ä–¥   - –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"
    echo "  3Ô∏è‚É£ System launcher  - –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
    echo "  4Ô∏è‚É£ –ü—Ä–æ—Å—Ç–æ–π —Ä–µ–∂–∏–º    - –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫"
    echo
    echo "üîß –°–ò–°–¢–ï–ú–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:"
    echo "  ‚ñ∂ Linux/Unix —Å–∏—Å—Ç–µ–º–∞"
    echo "  ‚ñ∂ Python 3.8+"
    echo "  ‚ñ∂ python3-venv –º–æ–¥—É–ª—å"
    echo "  ‚ñ∂ 4GB RAM (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8GB)"
    echo "  ‚ñ∂ 2GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞"
    echo "  ‚ñ∂ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ"
    echo
    echo "üõ†Ô∏è –í–ò–†–¢–£–ê–õ–¨–ù–û–ï –û–ö–†–£–ñ–ï–ù–ò–ï:"
    echo "  ‚ñ∂ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ venv"
    echo "  ‚ñ∂ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏"
    echo "  ‚ñ∂ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤"
    echo "  ‚ñ∂ –ü—É—Ç—å: ./$VENV_DIR/"
    echo
    echo "üì¶ –ó–ê–í–ò–°–ò–ú–û–°–¢–ò:"
    echo "  ‚ñ∂ numpy, pandas - –ß–∏—Å–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è"
    echo "  ‚ñ∂ matplotlib - –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è"
    echo "  ‚ñ∂ requests - HTTP –∫–ª–∏–µ–Ω—Ç"
    echo "  ‚ñ∂ fastapi - Web API"
    echo "  ‚ñ∂ websocket-client - WebSocket –ø–æ–¥–¥–µ—Ä–∂–∫–∞"
    echo
    echo "üÜò –ü–û–î–î–ï–†–ñ–ö–ê:"
    echo "  ‚ñ∂ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: README.md"
    echo "  ‚ñ∂ –õ–æ–≥–∏: logs/launcher.log"
    echo "  ‚ñ∂ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: launcher_config.json"
    echo "  ‚ñ∂ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: $VENV_DIR/"
    echo
    echo "üî• –ö–û–ú–ê–ù–î–´:"
    echo "  ‚ñ∂ –ó–∞–ø—É—Å–∫: ./start_atb_venv.sh"
    echo "  ‚ñ∂ –ê–∫—Ç–∏–≤–∞—Ü–∏—è venv: source $VENV_DIR/bin/activate"
    echo "  ‚ñ∂ –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è: deactivate"
    echo
    read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
}

# –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
end_operation() {
    echo
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "                      ‚úÖ –û–ü–ï–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo
    echo "$(date) - Operation completed (venv)" >> "$LOG_FILE"
    echo "üîÑ –î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞: ./start_atb_venv.sh"
    echo "üìã –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: $LOG_FILE"
    echo "üõ†Ô∏è Venv –∞–∫—Ç–∏–≤–Ω–æ: $VENV_DIR"
    echo
    read -p "üëã –ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é..."
}

# –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∏ –≤—ã—Ö–æ–¥
deactivate_and_exit() {
    echo
    echo "üîÑ –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
    deactivate 2>/dev/null || true
    echo "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ"
    exit 0
}

# –í—ã—Ö–æ–¥
exit_launcher() {
    clear
    echo
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo "                        üëã –ó–ê–í–ï–†–®–ï–ù–ò–ï –†–ê–ë–û–¢–´"
    echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
    echo
    echo "$(date) - Launcher shutdown (venv)" >> "$LOG_FILE"
    echo "‚úÖ –°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ATB Trading Dashboard!"
    echo "üìà –£–¥–∞—á–Ω—ã—Ö —Ç–æ—Ä–≥–æ–≤!"
    echo
    echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫: ./start_atb_venv.sh"
    echo "üìã –õ–æ–≥–∏: $LOG_FILE"
    echo "üõ†Ô∏è Venv –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º: $VENV_DIR"
    echo
    sleep 3
    exit 0
}

# –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
main() {
    # –ü—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã
    check_python
    setup_virtual_environment
    check_base_modules
    check_gui
    install_requirements
    check_scientific_libs
    check_optional_features
    check_file_structure
    check_config
    
    # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    main_menu
}

# –ó–∞–ø—É—Å–∫
main "$@"