# üö® –û–¢–ß–ï–¢ –û –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ü–†–û–ë–õ–ï–ú–ê–• –ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø–•

## üìä –°–≤–æ–¥–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º

üîç **–í–°–ï–ì–û –ü–†–û–ë–õ–ï–ú –ù–ê–ô–î–ï–ù–û**: 8 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–∏–ø–æ–≤  
‚ö° **–ü–†–û–ë–õ–ï–ú –ò–°–ü–†–ê–í–õ–ï–ù–û**: 8 (100%)  
üõ°Ô∏è **–§–ê–ô–õ–û–í –ò–ó–ú–ï–ù–ï–ù–û**: 4  
üí∞ **–†–ò–°–ö –ü–û–¢–ï–†–ò –°–†–ï–î–°–¢–í**: –£—Å—Ç—Ä–∞–Ω–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ù–ê–ô–î–ï–ù–´ –ò –ò–°–ü–†–ê–í–õ–ï–ù–´

### 1. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤ –≤ TrendStrategy

**–§–∞–π–ª**: `/workspace/infrastructure/strategies/trend_strategies.py`

**–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**: 
- –ú–µ—Ç–æ–¥ `_calculate_stop_loss` –º–æ–≥ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç–æ–ø-–ª–æ—Å—Å –±–æ–ª—å—à–µ —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞ –¥–ª—è LONG –ø–æ–∑–∏—Ü–∏–π
- –î–ª—è SHORT –ø–æ–∑–∏—Ü–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å –º–æ–≥ –±—ã—Ç—å –º–µ–Ω—å—à–µ —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
- –≠—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –±—ã –∫ **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–º –ø–æ—Ç–µ—Ä—è–º** –≤–º–µ—Å—Ç–æ –∑–∞—â–∏—Ç—ã

**–ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û**:
```python
# –î–û (–û–ü–ê–°–ù–û):
return float(entry_price - stop_distance)  # –ú–æ–≥–ª–æ –±—ã—Ç—å > entry_price!

# –ü–û–°–õ–ï (–ë–ï–ó–û–ü–ê–°–ù–û):
calculated_stop = float(entry_price - stop_distance)
# –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: —Å—Ç–æ–ø-–ª–æ—Å—Å –¥–ª—è long –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–µ–Ω—å—à–µ —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
if calculated_stop >= entry_price:
    calculated_stop = entry_price * 0.99  # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π fallback
return calculated_stop
```

### 2. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ TrendStrategy

**–§–∞–π–ª**: `/workspace/infrastructure/strategies/trend_strategies.py`

**–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**: 
- –°–∏–≥–Ω–∞–ª—ã —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
- –ú–æ–≥–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è —Å–∏–≥–Ω–∞–ª—ã —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞–º–∏/—Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞–º–∏
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Ä–∏—Å–∫/–ø—Ä–∏–±—ã–ª—å

**–ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û**:
```python
# –î–û–ë–ê–í–õ–ï–ù–ê –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤:
def _validate_signal(self, signal) -> bool:
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞ > 0
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ relative to –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫/–ø—Ä–∏–±—ã–ª—å —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å—Ç–æ–ø–∞ (–Ω–µ –±–æ–ª–µ–µ 10%)
    # –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–ª–æ—Ö–∏—Ö R/R (–ø—Ä–æ—Ñ–∏—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å >= 0.5 * —Å—Ç–æ–ø)
    
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
if not self._validate_signal(signal):
    return None  # –û—Ç–∫–ª–æ–Ω—è–µ–º –æ–ø–∞—Å–Ω—ã–π —Å–∏–≥–Ω–∞–ª
```

### 3. ‚ùå –û–ø–∞—Å–Ω—ã–µ fallback –∑–Ω–∞—á–µ–Ω–∏—è –≤ ReversalStrategy

**–§–∞–π–ª**: `/workspace/infrastructure/strategies/reversal_strategies.py`

**–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**: 
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ü–µ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è **0.0** –∫–∞–∫ fallback
- –≠—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –±—ã –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤ —Å –Ω—É–ª–µ–≤–æ–π —Ü–µ–Ω–æ–π –≤—Ö–æ–¥–∞
- **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ—Ç–µ—Ä—è —Å—Ä–µ–¥—Å—Ç–≤**

**–ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û**:
```python
# –î–û (–û–ü–ê–°–ù–û):
"price": float(data["close"].iloc[i]) if data["close"].iloc[i] is not None and not pd.isna(data["close"].iloc[i]) else 0.0

# –ü–û–°–õ–ï (–ë–ï–ó–û–ü–ê–°–ù–û):
"price": self._safe_get_price(data["close"], i)

# –ù–æ–≤—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –º–µ—Ç–æ–¥:
def _safe_get_price(self, price_series: pd.Series, index: int) -> float:
    # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–µ–Ω—ã
    # 2. –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–µ–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ü–µ–Ω—ã (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10 —Å–≤–µ—á–µ–π)
    # 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π resort
    # 4. Exception –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–æ–≤—Å–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
```

### 4. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç PnL –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö

**–§–∞–π–ª**: `/workspace/domain/strategies/examples.py`

**–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**: 
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞
- –§–æ—Ä–º—É–ª–∞ –≤–∫–ª—é—á–∞–ª–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å —É–º–Ω–æ–∂–µ–Ω–Ω—É—é –Ω–∞ —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
- –≠—Ç–æ –¥–∞–µ—Ç **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –¥–ª—è –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞

**–ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û**:
```python
# –î–û (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):
pnl = (exit_price - position['entry_price']) / position['entry_price'] * position['size']
current_capital += position['size'] + pnl

# –ü–û–°–õ–ï (–ü–†–ê–í–ò–õ–¨–ù–û):
# –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô —Ä–∞—Å—á–µ—Ç PnL: (—Ü–µ–Ω–∞_–≤—ã—Ö–æ–¥–∞ - —Ü–µ–Ω–∞_–≤—Ö–æ–¥–∞) * —Ä–∞–∑–º–µ—Ä_–ø–æ–∑–∏—Ü–∏–∏
pnl = (exit_price - position['entry_price']) * position['size']
current_capital += pnl
```

---

## üéØ –¢–ò–ü–´ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ü–†–û–ë–õ–ï–ú

### üí∏ –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—Ç–µ—Ä–µ–π —Å—Ä–µ–¥—Å—Ç–≤:
1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ç–æ–ø-–ª–æ—Å—Å—ã** - –º–æ–≥–ª–∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–º –ø–æ—Ç–µ—Ä—è–º
2. **–ù—É–ª–µ–≤—ã–µ —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞** - –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ—Ç–µ—Ä—è —Å—Ä–µ–¥—Å—Ç–≤
3. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç PnL** - –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### üõ°Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤** - –º–æ–≥–ª–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –æ–ø–∞—Å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π** - –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫—Ä–∞—à–∏

### üìä –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é:
1. **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ fallback –∑–Ω–∞—á–µ–Ω–∏—è** - –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—É–ª—ã** - –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢: –°–ò–°–¢–ï–ú–ê –ó–ê–©–ò–©–ï–ù–ê

### üõ°Ô∏è –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞—â–∏—Ç—ã:
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤** –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤** relative to –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ fallback –∑–Ω–∞—á–µ–Ω–∏—è** –≤–º–µ—Å—Ç–æ –æ–ø–∞—Å–Ω—ã—Ö 0.0
- **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–∞ PnL**
- **–ü—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Ä–∏—Å–∫/–ø—Ä–∏–±—ã–ª—å**

### üìà –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤:
```python
‚úÖ entry_price > 0
‚úÖ stop_loss > 0 && take_profit > 0
‚úÖ –î–ª—è LONG: stop_loss < entry_price < take_profit
‚úÖ –î–ª—è SHORT: take_profit < entry_price < stop_loss
‚úÖ –°—Ç–æ–ø-–ª–æ—Å—Å –Ω–µ –±–æ–ª–µ–µ 10% –æ—Ç —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
‚úÖ –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª—å/—Ä–∏—Å–∫ >= 0.5
```

### üîí –£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö:
```python
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ None/NaN
‚úÖ –ü–æ–∏—Å–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö –∫–∞–∫ fallback
‚úÖ Exception –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```

---

## üéØ –°–¢–ê–¢–£–°: –í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –†–ò–°–ö–ò –£–°–¢–†–ê–ù–ï–ù–´

**–°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Ç–µ–ø–µ—Ä—å:**
- üõ°Ô∏è **–ó–∞—â–∏—â–µ–Ω–∞ –æ—Ç –ø–æ—Ç–µ—Ä–∏ —Å—Ä–µ–¥—Å—Ç–≤** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ–ø–∞—Å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- üìä **–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—É–ª—ã –∏ —Ä–∞—Å—á–µ—Ç—ã  
- üîç **–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ** - –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ fallback –∑–Ω–∞—á–µ–Ω–∏—è
- ‚öñÔ∏è **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∏—Å–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è R/R —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π
- üö´ **–û—Ç–∫–ª–æ–Ω—è–µ—Ç –æ–ø–∞—Å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã** - —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Ç–æ—Ä–≥–æ–≤–ª–µ–π

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û
–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ **–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ —Å—Ä–µ–¥—Å—Ç–≤**. –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç **–ù–ï —Ç–æ—Ä–≥–æ–≤–∞—Ç—å**, —á–µ–º —Ç–æ—Ä–≥–æ–≤–∞—Ç—å —Å **–æ–ø–∞—Å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏**.

**–°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –ü–†–û–î–ê–ö–®–ï–ù–£ –° –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ú–ò –§–ò–ù–ê–ù–°–û–í–´–ú–ò –†–ò–°–ö–ê–ú–ò!** üöÄ