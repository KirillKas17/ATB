"""
Unit тесты для ExchangeCache
"""
import asyncio
import time
import pytest
from typing import Any, Dict, List, Optional, Union, AsyncGenerator
from infrastructure.external_services.exchanges.cache import ExchangeCache
class TestExchangeCache:
    """Тесты для ExchangeCache."""
    @pytest.fixture
    def cache(self: "TestEvolvableMarketMakerAgent") -> Any:
        """Экземпляр ExchangeCache."""
        return ExchangeCache(max_size=10, ttl=1)
        # Ждем, пока значение истечет
        # Заполняем кэш до максимума
        # Добавляем еще один элемент
        # Самый старый элемент должен быть удален
        # Устанавливаем значения с разными TTL
        # Ждем, пока первое значение истечет
        # Добавляем новый элемент
        # Проверяем, что истекшее значение удалено
        # Ждем, пока первое значение истечет
        # Истекшие ключи должны быть удалены
        # Выполняем конкурентные операции
        # Запускаем читателя и писателя одновременно
        # Проверяем, что операции завершились без ошибок
        # Устанавливаем много значений
        # Читаем значения
        # Операции должны выполняться быстро
        # Устанавливаем значения до достижения лимита
        # Добавляем еще один элемент
        # Размер должен остаться в пределах лимита
        # Самый старый элемент должен быть удален
        # Проверяем, что значение доступно сразу
        # Ждем половину TTL
        # Значение все еще должно быть доступно
        # Ждем полный TTL
        # Значение должно истечь
        # Кэш с нулевым размером
        # Кэш с очень большим TTL
        # Кэш с очень коротким TTL
        # Выполняем смешанные операции конкурентно
        # Все операции должны завершиться без ошибок
