#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Twitch Demo Page for ATB Trading System
–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ Twitch —Å –∂–∏–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
"""

from PyQt6.QtWidgets import *
from PyQt6.QtGui import *
from PyQt6.QtCore import *
from PyQt6.QtCharts import *
import random
import time
from datetime import datetime, timedelta
from modern_style_system import *

class TwitchDemoPage(QWidget):
    """–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ Twitch"""
    
    def __init__(self, parent=None) -> None:
        super().__init__(parent)
        self.init_ui()
        self.setup_timers()
        self.generate_demo_data()
    
    def init_ui(self) -> None:
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"""
        layout = QVBoxLayout(self)
        layout.setContentsMargins(0, 0, 0, 0)
        layout.setSpacing(0)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        header = self.create_header()
        layout.addWidget(header)
        
        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
        content = self.create_content()
        layout.addWidget(content)
    
    def create_header(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞"""
        header_widget = QWidget()
        header_widget.setFixedHeight(80)
        header_widget.setStyleSheet(f"""
            background: {ModernStyleSystem.COLORS['gradient_primary']};
            border-bottom: 1px solid {ModernStyleSystem.COLORS['surface_secondary']};
        """)
        
        layout = QHBoxLayout(header_widget)
        layout.setContentsMargins(24, 16, 24, 16)
        
        # –õ–æ–≥–æ—Ç–∏–ø –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
        title_layout = QHBoxLayout()
        
        # –ò–∫–æ–Ω–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏
        icon_label = QLabel("üìà")
        icon_label.setStyleSheet("font-size: 32px; margin-right: 16px;")
        title_layout.addWidget(icon_label)
        
        title_label = QLabel("ATB Trading System - LIVE")
        title_label.setStyleSheet("""
            font-size: 28px;
            font-weight: 700;
            color: white;
        """)
        title_layout.addWidget(title_label)
        
        layout.addLayout(title_layout)
        layout.addStretch()
        
        # –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
        self.status_label = QLabel("üü¢ SYSTEM ACTIVE")
        self.status_label.setStyleSheet("""
            font-size: 16px;
            font-weight: 600;
            color: white;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
        """)
        layout.addWidget(self.status_label)
        
        return header_widget
    
    def create_content(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
        content_widget = QWidget()
        layout = QHBoxLayout(content_widget)
        layout.setContentsMargins(24, 24, 24, 24)
        layout.setSpacing(24)
        
        # –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å - –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        left_panel = self.create_left_panel()
        layout.addWidget(left_panel, 2)
        
        # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å - –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
        center_panel = self.create_center_panel()
        layout.addWidget(center_panel, 3)
        
        # –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å - –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∏ —Å–¥–µ–ª–∫–∏
        right_panel = self.create_right_panel()
        layout.addWidget(right_panel, 2)
        
        return content_widget
    
    def create_left_panel(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ —Å –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π"""
        panel = QWidget()
        layout = QVBoxLayout(panel)
        layout.setSpacing(16)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ModernLabel("üìä LIVE STATISTICS", "subtitle")
        layout.addWidget(title)
        
        # –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        self.pnl_card = self.create_stat_card("üí∞ P&L Today", "$0.00", "success")
        layout.addWidget(self.pnl_card)
        
        self.trades_card = self.create_stat_card("üîÑ Total Trades", "0", "primary")
        layout.addWidget(self.trades_card)
        
        self.winrate_card = self.create_stat_card("üéØ Win Rate", "0%", "info")
        layout.addWidget(self.winrate_card)
        
        self.volume_card = self.create_stat_card("üìà Volume 24h", "$0.00", "warning")
        layout.addWidget(self.volume_card)
        
        # –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
        time_stats = self.create_time_stats()
        layout.addWidget(time_stats)
        
        layout.addStretch()
        return panel
    
    def create_stat_card(self, title, value, color_type) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
        card = GlassCard()
        card_layout = QVBoxLayout(card)
        card_layout.setSpacing(8)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ModernLabel(title, "caption")
        card_layout.addWidget(title_label)
        
        # –ó–Ω–∞—á–µ–Ω–∏–µ
        value_label = QLabel(value)
        value_label.setStyleSheet(f"""
            font-size: 32px;
            font-weight: 700;
            color: {ModernStyleSystem.COLORS[color_type]};
            margin: 8px 0;
        """)
        value_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
        card_layout.addWidget(value_label)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        card.value_label = value_label
        card.color_type = color_type
        
        return card
    
    def create_time_stats(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º"""
        card = GlassCard("‚è∞ Time Intervals")
        layout = QGridLayout(card)
        layout.setSpacing(12)
        
        # –ó–∞–≥–æ–ª–æ–≤–∫–∏
        headers = ["Period", "Trades", "P&L", "Volume"]
        for i, header in enumerate(headers):
            header_label = ModernLabel(header, "caption")
            header_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
            layout.addWidget(header_label, 0, i)
        
        # –î–∞–Ω–Ω—ã–µ
        periods = ["1 Hour", "1 Day", "1 Week", "1 Month"]
        self.time_stats_labels = {}
        
        for i, period in enumerate(periods):
            # –ü–µ—Ä–∏–æ–¥
            period_label = ModernLabel(period, "body")
            layout.addWidget(period_label, i+1, 0)
            
            # –¢–æ—Ä–≥–æ–≤–ª–∏
            trades_label = ModernLabel("0", "body")
            trades_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
            layout.addWidget(trades_label, i+1, 1)
            
            # P&L
            pnl_label = ModernLabel("$0.00", "body")
            pnl_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
            layout.addWidget(pnl_label, i+1, 2)
            
            # –û–±—ä–µ–º
            volume_label = ModernLabel("$0.00", "body")
            volume_label.setAlignment(Qt.AlignmentFlag.AlignCenter)
            layout.addWidget(volume_label, i+1, 3)
            
            self.time_stats_labels[period] = {
                'trades': trades_label,
                'pnl': pnl_label,
                'volume': volume_label
            }
        
        return card
    
    def create_center_panel(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª–∏ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏"""
        panel = QWidget()
        layout = QVBoxLayout(panel)
        layout.setSpacing(16)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ModernLabel("üìà LIVE CHARTS", "subtitle")
        layout.addWidget(title)
        
        # –ì—Ä–∞—Ñ–∏–∫ P&L
        pnl_chart = self.create_pnl_chart()
        layout.addWidget(pnl_chart)
        
        # –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        activity_chart = self.create_activity_chart()
        layout.addWidget(activity_chart)
        
        return panel
    
    def create_pnl_chart(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ P&L"""
        card = GlassCard("üí∞ Profit & Loss")
        
        chart_view = ModernChart()
        chart = chart_view.chart()
        chart.setTitle("Real-time P&L")
        
        # –°–æ–∑–¥–∞–µ–º —Å–µ—Ä–∏—é –¥–∞–Ω–Ω—ã—Ö
        self.pnl_series = QLineSeries()
        self.pnl_series.setName("P&L")
        self.pnl_series.setPen(QPen(QColor(ModernStyleSystem.COLORS['success']), 3))
        
        chart.addSeries(self.pnl_series)
        
        # –û—Å–∏
        axis_x = QValueAxis()
        axis_x.setRange(0, 24)
        axis_x.setTitleText("Hours")
        axis_x.setLabelFormat("%d")
        
        axis_y = QValueAxis()
        axis_y.setRange(-1000, 1000)
        axis_y.setTitleText("P&L ($)")
        axis_y.setLabelFormat("%.0f")
        
        chart.addAxis(axis_x, Qt.AlignmentFlag.AlignBottom)
        chart.addAxis(axis_y, Qt.AlignmentFlag.AlignLeft)
        
        self.pnl_series.attachAxis(axis_x)
        self.pnl_series.attachAxis(axis_y)
        
        card_layout = QVBoxLayout(card)
        card_layout.addWidget(chart_view)
        
        return card
    
    def create_activity_chart(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
        card = GlassCard("üî• Trading Activity")
        
        chart_view = ModernChart()
        chart = chart_view.chart()
        chart.setTitle("Trades per Hour")
        
        # –°–æ–∑–¥–∞–µ–º —Å–µ—Ä–∏—é –¥–∞–Ω–Ω—ã—Ö
        self.activity_series = QBarSeries()
        
        # –°–æ–∑–¥–∞–µ–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
        self.activity_set = QBarSet("Trades")
        self.activity_set.setColor(QColor(ModernStyleSystem.COLORS['primary']))
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
        for i in range(24):
            self.activity_set.append(random.randint(0, 10))
        
        self.activity_series.append(self.activity_set)
        chart.addSeries(self.activity_series)
        
        # –û—Å–∏
        axis_x = QBarCategoryAxis()
        hours = [str(i) for i in range(24)]
        axis_x.append(hours)
        axis_x.setTitleText("Hour")
        
        axis_y = QValueAxis()
        axis_y.setRange(0, 15)
        axis_y.setTitleText("Number of Trades")
        
        chart.addAxis(axis_x, Qt.AlignmentFlag.AlignBottom)
        chart.addAxis(axis_y, Qt.AlignmentFlag.AlignLeft)
        
        self.activity_series.attachAxis(axis_x)
        self.activity_series.attachAxis(axis_y)
        
        card_layout = QVBoxLayout(card)
        card_layout.addWidget(chart_view)
        
        return card
    
    def create_right_panel(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏"""
        panel = QWidget()
        layout = QVBoxLayout(panel)
        layout.setSpacing(16)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ModernLabel("üéØ ACTIVE POSITIONS", "subtitle")
        layout.addWidget(title)
        
        # –¢–∞–±–ª–∏—Ü–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
        positions_table = self.create_positions_table()
        layout.addWidget(positions_table)
        
        # –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–¥–µ–ª–∫–∏
        recent_trades = self.create_recent_trades()
        layout.addWidget(recent_trades)
        
        return panel
    
    def create_positions_table(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π"""
        card = GlassCard("üìä Open Positions")
        
        table = ModernTable()
        table.setColumnCount(5)
        table.setHorizontalHeaderLabels(["Symbol", "Side", "Size", "Entry", "P&L"])
        table.setRowCount(0)
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
        table.horizontalHeader().setSectionResizeMode(0, QHeaderView.ResizeMode.Stretch)
        table.horizontalHeader().setSectionResizeMode(1, QHeaderView.ResizeMode.ResizeToContents)
        table.horizontalHeader().setSectionResizeMode(2, QHeaderView.ResizeMode.ResizeToContents)
        table.horizontalHeader().setSectionResizeMode(3, QHeaderView.ResizeMode.ResizeToContents)
        table.horizontalHeader().setSectionResizeMode(4, QHeaderView.ResizeMode.ResizeToContents)
        
        self.positions_table = table
        
        card_layout = QVBoxLayout(card)
        card_layout.addWidget(table)
        
        return card
    
    def create_recent_trades(self) -> None:
        """–°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–¥–µ–ª–æ–∫"""
        card = GlassCard("üîÑ Recent Trades")
        
        table = ModernTable()
        table.setColumnCount(6)
        table.setHorizontalHeaderLabels(["Time", "Symbol", "Side", "Size", "Price", "P&L"])
        table.setRowCount(0)
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
        table.horizontalHeader().setSectionResizeMode(0, QHeaderView.ResizeMode.ResizeToContents)
        table.horizontalHeader().setSectionResizeMode(1, QHeaderView.ResizeMode.ResizeToContents)
        table.horizontalHeader().setSectionResizeMode(2, QHeaderView.ResizeMode.ResizeToContents)
        table.horizontalHeader().setSectionResizeMode(3, QHeaderView.ResizeMode.ResizeToContents)
        table.horizontalHeader().setSectionResizeMode(4, QHeaderView.ResizeMode.ResizeToContents)
        table.horizontalHeader().setSectionResizeMode(5, QHeaderView.ResizeMode.ResizeToContents)
        
        self.trades_table = table
        
        card_layout = QVBoxLayout(card)
        card_layout.addWidget(table)
        
        return card
    
    def setup_timers(self) -> None:
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–π–º–µ—Ä–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö"""
        # –¢–∞–π–º–µ—Ä –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        self.stats_timer = QTimer()
        self.stats_timer.timeout.connect(self.update_statistics)
        self.stats_timer.start(2000)  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
        
        # –¢–∞–π–º–µ—Ä –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
        self.chart_timer = QTimer()
        self.chart_timer.timeout.connect(self.update_charts)
        self.chart_timer.start(5000)  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
        
        # –¢–∞–π–º–µ—Ä –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π
        self.positions_timer = QTimer()
        self.positions_timer.timeout.connect(self.update_positions)
        self.positions_timer.start(3000)  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
    
    def generate_demo_data(self) -> None:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
        self.demo_data = {
            'total_pnl': 0.0,
            'total_trades': 0,
            'win_rate': 0.0,
            'volume_24h': 0.0,
            'positions': [],
            'trades': [],
            'hourly_pnl': [0] * 24,
            'hourly_trades': [0] * 24
        }
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
        symbols = ["BTC/USDT", "ETH/USDT", "BNB/USDT", "ADA/USDT", "SOL/USDT"]
        sides = ["LONG", "SHORT"]
        
        for i in range(3):
            position = {
                'symbol': random.choice(symbols),
                'side': random.choice(sides),
                'size': round(random.uniform(0.1, 2.0), 2),
                'entry_price': round(random.uniform(100, 50000), 2),
                'current_price': round(random.uniform(100, 50000), 2),
                'pnl': round(random.uniform(-500, 500), 2)
            }
            self.demo_data['positions'].append(position)
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ —Å–¥–µ–ª–∫–∏
        for i in range(10):
            trade = {
                'time': datetime.now() - timedelta(minutes=random.randint(1, 60)),
                'symbol': random.choice(symbols),
                'side': random.choice(sides),
                'size': round(random.uniform(0.1, 1.0), 2),
                'price': round(random.uniform(100, 50000), 2),
                'pnl': round(random.uniform(-100, 100), 2)
            }
            self.demo_data['trades'].append(trade)
    
    def update_statistics(self) -> None:
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
        # –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
        self.demo_data['total_pnl'] += random.uniform(-50, 50)
        self.demo_data['total_trades'] += random.randint(0, 2)
        self.demo_data['win_rate'] = random.uniform(60, 85)
        self.demo_data['volume_24h'] += random.uniform(100, 1000)
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
        self.pnl_card.value_label.setText(f"${self.demo_data['total_pnl']:,.2f}")
        self.trades_card.value_label.setText(f"{self.demo_data['total_trades']}")
        self.winrate_card.value_label.setText(f"{self.demo_data['win_rate']:.1f}%")
        self.volume_card.value_label.setText(f"${self.demo_data['volume_24h']:,.0f}")
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        for period in ["1 Hour", "1 Day", "1 Week", "1 Month"]:
            stats = self.time_stats_labels[period]
            stats['trades'].setText(str(random.randint(5, 50)))
            stats['pnl'].setText(f"${random.uniform(-1000, 2000):,.2f}")
            stats['volume'].setText(f"${random.uniform(1000, 10000):,.0f}")
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
        if random.random() > 0.95:  # 5% —à–∞–Ω—Å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
            if self.status_label.text() == "üü¢ SYSTEM ACTIVE":
                self.status_label.setText("üü° PROCESSING")
                self.status_label.setStyleSheet("""
                    font-size: 16px;
                    font-weight: 600;
                    color: white;
                    padding: 8px 16px;
                    background: rgba(255, 149, 0, 0.3);
                    border-radius: 20px;
                """)
            else:
                self.status_label.setText("üü¢ SYSTEM ACTIVE")
                self.status_label.setStyleSheet("""
                    font-size: 16px;
                    font-weight: 600;
                    color: white;
                    padding: 8px 16px;
                    background: rgba(255, 255, 255, 0.2);
                    border-radius: 20px;
                """)
    
    def update_charts(self) -> None:
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤"""
        # –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ P&L
        current_time = datetime.now().hour
        self.demo_data['hourly_pnl'][current_time] = self.demo_data['total_pnl']
        
        self.pnl_series.clear()
        for i, pnl in enumerate(self.demo_data['hourly_pnl']):
            self.pnl_series.append(i, pnl)
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        self.demo_data['hourly_trades'][current_time] += random.randint(0, 3)
        
        self.activity_set.remove(0, 24)
        for trades in self.demo_data['hourly_trades']:
            self.activity_set.append(trades)
    
    def update_positions(self) -> None:
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∏ —Å–¥–µ–ª–æ–∫"""
        # –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏–∏
        for position in self.demo_data['positions']:
            position['current_price'] += random.uniform(-100, 100)
            position['pnl'] = (position['current_price'] - position['entry_price']) * position['size']
            if position['side'] == 'SHORT':
                position['pnl'] = -position['pnl']
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–æ–∑–∏—Ü–∏–π
        self.positions_table.setRowCount(len(self.demo_data['positions']))
        for i, position in enumerate(self.demo_data['positions']):
            self.positions_table.setItem(i, 0, QTableWidgetItem(position['symbol']))
            self.positions_table.setItem(i, 1, QTableWidgetItem(position['side']))
            self.positions_table.setItem(i, 2, QTableWidgetItem(str(position['size'])))
            self.positions_table.setItem(i, 3, QTableWidgetItem(f"${position['entry_price']:,.2f}"))
            
            pnl_item = QTableWidgetItem(f"${position['pnl']:,.2f}")
            if position['pnl'] > 0:
                pnl_item.setForeground(QBrush(QColor(ModernStyleSystem.COLORS['success'])))
            else:
                pnl_item.setForeground(QBrush(QColor(ModernStyleSystem.COLORS['danger'])))
            self.positions_table.setItem(i, 4, pnl_item)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å–¥–µ–ª–∫–∏
        if random.random() > 0.7:  # 30% —à–∞–Ω—Å –Ω–æ–≤–æ–π —Å–¥–µ–ª–∫–∏
            symbols = ["BTC/USDT", "ETH/USDT", "BNB/USDT", "ADA/USDT", "SOL/USDT"]
            sides = ["LONG", "SHORT"]
            
            trade = {
                'time': datetime.now(),
                'symbol': random.choice(symbols),
                'side': random.choice(sides),
                'size': round(random.uniform(0.1, 1.0), 2),
                'price': round(random.uniform(100, 50000), 2),
                'pnl': round(random.uniform(-100, 100), 2)
            }
            self.demo_data['trades'].insert(0, trade)
            
            # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫
            if len(self.demo_data['trades']) > 20:
                self.demo_data['trades'] = self.demo_data['trades'][:20]
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É —Å–¥–µ–ª–æ–∫
        self.trades_table.setRowCount(len(self.demo_data['trades']))
        for i, trade in enumerate(self.demo_data['trades']):
            self.trades_table.setItem(i, 0, QTableWidgetItem(trade['time'].strftime("%H:%M:%S")))
            self.trades_table.setItem(i, 1, QTableWidgetItem(trade['symbol']))
            self.trades_table.setItem(i, 2, QTableWidgetItem(trade['side']))
            self.trades_table.setItem(i, 3, QTableWidgetItem(str(trade['size'])))
            self.trades_table.setItem(i, 4, QTableWidgetItem(f"${trade['price']:,.2f}"))
            
            pnl_item = QTableWidgetItem(f"${trade['pnl']:,.2f}")
            if trade['pnl'] > 0:
                pnl_item.setForeground(QBrush(QColor(ModernStyleSystem.COLORS['success'])))
            else:
                pnl_item.setForeground(QBrush(QColor(ModernStyleSystem.COLORS['danger'])))
            self.trades_table.setItem(i, 5, pnl_item) 